@tailwind base;
@tailwind components;
@tailwind utilities;

/* Mobile-First Design System - Native App Feel
High contrast colors for accessibility (WCAG AA compliant)
All colors MUST be HSL. Optimized for mobile experiences.
*/

@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
@import 'leaflet/dist/leaflet.css';

@layer base {
  :root {
    /* High contrast color palette for accessibility */
    --background: 0 0% 100%;
    --foreground: 220 13% 9%;

    --card: 0 0% 100%;
    --card-foreground: 220 13% 9%;

    --popover: 0 0% 100%;
    --popover-foreground: 220 13% 9%;

    /* Primary - High contrast blue for accessibility */
    --primary: 220 91% 42%;
    --primary-foreground: 0 0% 100%;
    --primary-light: 220 91% 52%;
    --primary-dark: 220 91% 32%;

    /* Secondary - Mobile-friendly grays */
    --secondary: 220 13% 95%;
    --secondary-foreground: 220 13% 9%;

    --muted: 220 13% 96%;
    --muted-foreground: 220 13% 45%;

    --accent: 220 91% 42%;
    --accent-foreground: 0 0% 100%;

    --destructive: 0 84% 37%;
    --destructive-foreground: 0 0% 100%;

    --border: 220 13% 87%;
    --input: 220 13% 87%;
    --ring: 220 91% 42%;

    --radius: 16px;

    /* Sidebar - Mobile drawer style */
    --sidebar-background: 220 13% 98%;
    --sidebar-foreground: 220 13% 9%;
    --sidebar-primary: 220 91% 42%;
    --sidebar-primary-foreground: 0 0% 100%;
    --sidebar-accent: 220 13% 95%;
    --sidebar-accent-foreground: 220 13% 9%;
    --sidebar-border: 220 13% 87%;
    --sidebar-ring: 220 91% 42%;

    /* High contrast status colors */
    --success: 142 71% 33%;
    --success-foreground: 0 0% 100%;
    --success-light: 142 71% 43%;
    
    --warning: 38 92% 40%;
    --warning-foreground: 0 0% 100%;
    --warning-light: 38 92% 50%;
    
    --info: 199 89% 35%;
    --info-foreground: 0 0% 100%;
    --info-light: 199 89% 45%;

    /* Mobile-optimized gradients */
    --gradient-hero: linear-gradient(180deg, hsl(var(--primary)) 0%, hsl(var(--primary-dark)) 100%);
    --gradient-surface: linear-gradient(180deg, hsl(var(--card)) 0%, hsl(var(--muted)) 100%);
    --gradient-subtle: linear-gradient(180deg, hsl(var(--background)) 0%, hsl(var(--muted)) 100%);

    /* Mobile-friendly shadows */
    --shadow-xs: 0 1px 2px 0 hsl(220 13% 9% / 0.08);
    --shadow-sm: 0 1px 3px 0 hsl(220 13% 9% / 0.12), 0 1px 2px -1px hsl(220 13% 9% / 0.12);
    --shadow-md: 0 4px 6px -1px hsl(220 13% 9% / 0.12), 0 2px 4px -2px hsl(220 13% 9% / 0.12);
    --shadow-lg: 0 10px 15px -3px hsl(220 13% 9% / 0.12), 0 4px 6px -4px hsl(220 13% 9% / 0.12);
    --shadow-xl: 0 20px 25px -5px hsl(220 13% 9% / 0.15), 0 8px 10px -6px hsl(220 13% 9% / 0.15);
    --shadow-2xl: 0 25px 50px -12px hsl(220 13% 9% / 0.25);
    --shadow-mobile: 0 4px 16px 0 hsl(220 13% 9% / 0.15);

    /* Mobile touch feedback */
    --touch-feedback: hsl(220 91% 42% / 0.1);
    --touch-pressed: hsl(220 91% 42% / 0.2);

    /* Mobile motion system */
    --motion-mobile: cubic-bezier(0.2, 0, 0, 1);
    --motion-bounce: cubic-bezier(0.68, -0.55, 0.265, 1.55);
    
    --transition-mobile: 200ms var(--motion-mobile);
    --transition-touch: 150ms var(--motion-mobile);
    --transition-bounce: 400ms var(--motion-bounce);

    /* Mobile typography */
    --font-family-mobile: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;

    /* Mobile spacing - Touch-friendly */
    --touch-target: 44px;
    --mobile-padding: 16px;
    --mobile-gap: 12px;
    --mobile-margin: 20px;
  }

  .dark {
    /* Dark theme - High contrast mobile palette */
    --background: 220 13% 6%;
    --foreground: 0 0% 95%;

    --card: 220 13% 8%;
    --card-foreground: 0 0% 95%;

    --popover: 220 13% 8%;
    --popover-foreground: 0 0% 95%;

    /* Dark theme primary - High contrast */
    --primary: 220 91% 65%;
    --primary-foreground: 220 13% 6%;
    --primary-light: 220 91% 75%;
    --primary-dark: 220 91% 55%;

    --secondary: 220 13% 15%;
    --secondary-foreground: 0 0% 95%;

    --muted: 220 13% 12%;
    --muted-foreground: 220 9% 70%;

    --accent: 220 91% 65%;
    --accent-foreground: 220 13% 6%;

    --destructive: 0 84% 65%;
    --destructive-foreground: 220 13% 6%;

    --border: 220 13% 20%;
    --input: 220 13% 20%;
    --ring: 220 91% 65%;

    /* Dark sidebar */
    --sidebar-background: 220 13% 8%;
    --sidebar-foreground: 0 0% 95%;
    --sidebar-primary: 220 91% 65%;
    --sidebar-primary-foreground: 220 13% 6%;
    --sidebar-accent: 220 13% 15%;
    --sidebar-accent-foreground: 0 0% 95%;
    --sidebar-border: 220 13% 20%;
    --sidebar-ring: 220 91% 65%;

    /* Dark status colors - High contrast */
    --success: 142 71% 55%;
    --success-foreground: 220 13% 6%;
    --success-light: 142 71% 65%;
    
    --warning: 38 92% 60%;
    --warning-foreground: 220 13% 6%;
    --warning-light: 38 92% 70%;
    
    --info: 199 89% 55%;
    --info-foreground: 220 13% 6%;
    --info-light: 199 89% 65%;

    /* Dark gradients */
    --gradient-hero: linear-gradient(180deg, hsl(var(--primary)) 0%, hsl(var(--primary-dark)) 100%);
    --gradient-surface: linear-gradient(180deg, hsl(var(--card)) 0%, hsl(var(--muted)) 100%);
    --gradient-subtle: linear-gradient(180deg, hsl(var(--background)) 0%, hsl(var(--muted)) 100%);

    /* Dark mobile shadows */
    --shadow-xs: 0 1px 2px 0 hsl(0 0% 0% / 0.4);
    --shadow-sm: 0 1px 3px 0 hsl(0 0% 0% / 0.5), 0 1px 2px -1px hsl(0 0% 0% / 0.5);
    --shadow-md: 0 4px 6px -1px hsl(0 0% 0% / 0.5), 0 2px 4px -2px hsl(0 0% 0% / 0.5);
    --shadow-lg: 0 10px 15px -3px hsl(0 0% 0% / 0.5), 0 4px 6px -4px hsl(0 0% 0% / 0.5);
    --shadow-xl: 0 20px 25px -5px hsl(0 0% 0% / 0.6), 0 8px 10px -6px hsl(0 0% 0% / 0.6);
    --shadow-2xl: 0 25px 50px -12px hsl(0 0% 0% / 0.7);
    --shadow-mobile: 0 4px 16px 0 hsl(0 0% 0% / 0.6);
    
    /* Touch feedback for dark mode */
    --touch-feedback: hsl(220 91% 65% / 0.15);
    --touch-pressed: hsl(220 91% 65% / 0.25);
  }
}

@layer base {
  * {
    @apply border-border;
  }

  body {
    @apply bg-background text-foreground antialiased;
    font-family: var(--font-family-mobile);
    -webkit-tap-highlight-color: var(--touch-feedback);
    -webkit-touch-callout: none;
    -webkit-user-select: none;
    user-select: none;
    overscroll-behavior: none;
  }

  h1, h2, h3, h4, h5, h6 {
    @apply font-semibold tracking-tight;
  }

  h1 {
    @apply text-4xl lg:text-5xl xl:text-6xl;
  }

  h2 {
    @apply text-3xl lg:text-4xl;
  }

  h3 {
    @apply text-2xl lg:text-3xl;
  }

  h4 {
    @apply text-xl lg:text-2xl;
  }

  p {
    @apply leading-7;
  }

  /* Smooth scrolling */
  html {
    scroll-behavior: smooth;
  }

  /* Focus styles */
  :focus-visible {
    @apply ring-2 ring-primary ring-offset-2 ring-offset-background outline-none;
  }

  /* Selection styles */
  ::selection {
    @apply bg-primary/20 text-primary-foreground;
  }
}

@layer utilities {
  /* Gradient utilities */
  .bg-gradient-hero {
    background-image: var(--gradient-hero);
  }
  
  .bg-gradient-surface {
    background-image: var(--gradient-surface);
  }
  
  .bg-gradient-subtle {
    background-image: var(--gradient-subtle);
  }

  /* Shadow utilities */
  .shadow-xs { box-shadow: var(--shadow-xs); }
  .shadow-sm { box-shadow: var(--shadow-sm); }
  .shadow-md { box-shadow: var(--shadow-md); }
  .shadow-lg { box-shadow: var(--shadow-lg); }
  .shadow-xl { box-shadow: var(--shadow-xl); }
  .shadow-2xl { box-shadow: var(--shadow-2xl); }
  .shadow-glow { box-shadow: var(--shadow-glow); }

  /* Transition utilities */
  .transition-mobile { transition: var(--transition-mobile); }
  .transition-touch { transition: var(--transition-touch); }
  .transition-bounce { transition: var(--transition-bounce); }

  /* Interactive utilities */
  .hover-lift {
    @apply transition-all duration-300 ease-out;
  }
  
  .hover-lift:hover {
    transform: translateY(-2px);
    box-shadow: var(--shadow-lg);
  }

  .hover-scale {
    @apply transition-transform duration-200 ease-out;
  }
  
  .hover-scale:hover {
    transform: scale(1.02);
  }

  .hover-glow:hover {
    box-shadow: var(--shadow-glow);
  }

  /* Backdrop utilities */
  .backdrop-glass {
    @apply backdrop-blur-lg bg-white/10 border border-white/20;
  }

  .backdrop-glass-dark {
    @apply backdrop-blur-lg bg-black/10 border border-white/10;
  }

  /* Text utilities */
  .text-gradient {
    background: linear-gradient(135deg, hsl(var(--primary)), hsl(var(--info)));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }

  /* Layout utilities */
  .container-custom {
    @apply mx-auto max-w-7xl px-6 lg:px-8;
  }

  /* Card utilities */
  .card-modern {
    @apply bg-card/80 backdrop-blur-sm border border-border/50 rounded-2xl shadow-sm hover-lift;
  }

  .card-glass {
    @apply backdrop-glass rounded-2xl shadow-lg hover-lift;
  }

  /* Button utilities */
  .btn-primary {
    @apply bg-primary hover:bg-primary-dark text-primary-foreground shadow-md hover:shadow-lg transition-all duration-200;
  }

  .btn-secondary {
    @apply bg-secondary hover:bg-muted text-secondary-foreground shadow-sm hover:shadow-md transition-all duration-200;
  }

  /* Animation utilities */
  .animate-fade-in {
    animation: fadeIn 0.6s ease-out;
  }

  .animate-slide-up {
    animation: slideUp 0.6s ease-out;
  }

  .animate-scale-in {
    animation: scaleIn 0.4s ease-out;
  }

  .animate-float {
    animation: float 3s ease-in-out infinite;
  }

  /* Mobile-specific utilities */
  .mobile-container {
    @apply px-4 mx-auto max-w-sm;
  }

  .touch-target {
    min-height: var(--touch-target);
    min-width: var(--touch-target);
    @apply flex items-center justify-center;
  }

  .mobile-card {
    @apply bg-card rounded-2xl shadow-mobile border border-border/30 p-4 transition-mobile;
  }

  .mobile-button {
    @apply touch-target bg-primary text-primary-foreground rounded-2xl font-medium shadow-md active:scale-95 active:shadow-sm transition-mobile;
  }

  .mobile-button-secondary {
    @apply touch-target bg-secondary text-secondary-foreground rounded-2xl font-medium shadow-sm active:scale-95 transition-mobile;
  }

  .mobile-input {
    @apply w-full h-12 bg-background border-2 border-border rounded-2xl px-4 text-base focus:border-primary focus:ring-0 transition-mobile;
  }

  .mobile-tab {
    @apply flex-1 touch-target rounded-xl font-medium transition-mobile active:scale-95;
  }

  .mobile-tab-active {
    @apply bg-primary text-primary-foreground shadow-sm;
  }

  .mobile-tab-inactive {
    @apply bg-transparent text-muted-foreground;
  }

  .mobile-list-item {
    @apply flex items-center p-4 bg-card rounded-2xl shadow-sm border border-border/30 active:scale-98 transition-mobile;
  }

  .mobile-floating-button {
    @apply fixed bottom-20 right-6 w-14 h-14 bg-primary text-primary-foreground rounded-full shadow-xl active:scale-90 transition-mobile flex items-center justify-center z-40;
  }

  .mobile-header {
    @apply sticky top-0 z-40 bg-background/95 backdrop-blur-md border-b border-border/50 p-4;
  }

  .mobile-bottom-nav {
    @apply fixed bottom-0 left-0 right-0 bg-background/95 backdrop-blur-md border-t border-border/50 p-2 safe-area-inset-bottom;
  }

  .mobile-safe-top {
    padding-top: env(safe-area-inset-top);
  }

  .mobile-safe-bottom {
    padding-bottom: env(safe-area-inset-bottom);
  }

  /* Touch feedback */
  .touch-feedback {
    @apply active:bg-touch-pressed transition-colors duration-75;
  }

  /* Pull to refresh indicator */
  .pull-to-refresh {
    @apply h-16 flex items-center justify-center text-muted-foreground;
  }
}

@layer components {
  /* Modern keyframe animations */
  @keyframes fadeIn {
    from {
      opacity: 0;
      transform: translateY(20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @keyframes slideUp {
    from {
      opacity: 0;
      transform: translateY(40px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @keyframes scaleIn {
    from {
      opacity: 0;
      transform: scale(0.95);
    }
    to {
      opacity: 1;
      transform: scale(1);
    }
  }

  @keyframes float {
    0%, 100% {
      transform: translateY(0px);
    }
    50% {
      transform: translateY(-10px);
    }
  }
}

.leaflet-container {
  height: 100% !important;
  width: 100% !important;
  z-index: 1 !important;
  position: absolute !important;
  inset: 0 !important;
  background: hsl(var(--muted) / 0.3) !important;
}

.leaflet-tile-pane,
.leaflet-tile-container {
  z-index: 2 !important;
}

.leaflet-tile,
.map-tile-layer,
img.leaflet-tile {
  opacity: 1 !important;
  z-index: 2 !important;
  animation: fadeIn 0.3s ease-in !important;
}

.leaflet-pane {
  z-index: auto !important;
}

.leaflet-map-pane {
  z-index: 2 !important;
}

.leaflet-overlay-pane {
  z-index: 4 !important;
}

.leaflet-marker-pane {
  z-index: 6 !important;
}

.leaflet-popup-pane {
  z-index: 7 !important;
}

.leaflet-control-container {
  z-index: 8 !important;
}

/* Route and station marker animations */
.station-marker {
  transition: all 0.3s ease;
}

.station-path {
  transition: all 0.3s ease;
}

.route-line {
  stroke-dasharray: 10, 10;
  animation: dash 30s linear infinite;
}

@keyframes dash {
  to {
    stroke-dashoffset: -1000;
  }
}

@keyframes scale-in {
  from {
    opacity: 0;
    transform: scale(0.5);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}